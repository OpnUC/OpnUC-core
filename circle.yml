machine:
  environment:
    APP_ENV: testing
    APP_DEBUG: true
    DB_HOST: 127.0.0.1
    DB_DATABASE: circle_test
    DB_USERNAME: ubuntu
    DB_PASSWORD:
    CACHE_DRIVER: array
  php:
    version: 7.1.9
  node:
    version: 6.3.0
  post:
     - npm install -g npm@3
  timezone: Asia/Tokyo

dependencies:
  pre:
    - npm config set registry http://registry.npmjs.org/

database:
  override:
#    - php artisan migrate

test:
  pre:
    - cp .env.example .env
    - php artisan key:generate
    - sudo service redis-server start
#    - php artisan migrate
#    - php artisan db:seed
  post:
    - bash <(curl -s https://codecov.io/bash)
  override:
    - vendor/bin/phpunit -d memory_limit=512M --coverage-clover=coverage.xml
